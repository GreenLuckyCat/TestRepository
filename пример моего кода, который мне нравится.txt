public bool TestConfig()
        {
            string pathToXML = GetPathToConfigXML();
            bool isCheckFailed = true;
            string msgErr = "";
            for (int i = 1; i <= countChecks; i++)
            {
                switch (i)
                {
                    case 1:
                        isCheckFailed = !File.Exists(pathToXML);
                        msgErr = "Отсутствует файл настроек.";
                        break;
                    case 2:
                        document = new XmlDocument();
                        msgErr = "Не удалось загрузить настройки подключения.";
                        try
                        {
                            document.Load(pathToXML);
                            isCheckFailed = false;
                        }
                        catch { } //обрабатывается через isCheckFailed = true 
                        break;
                    case 3:
                        XmlNodeList list = document.GetElementsByTagName("DataBase");
                        isCheckFailed = list.Count != 1;
                        msgErr = "Файл настроек содержит недопустимые данные.";
                        break;
                    case 4:
                        msgErr = "В настройках указан неизвестный тип БД.";
                        switch (GetDataBaseType())
                        {
                            case "MySQL":
                                dbc = new MySQLDataBaseConnection();
                                isCheckFailed = false;
                                break;
                        }
                        break;
                    case 5:
                        dbc.DoConnect(GetConnectionData());
                        msgErr = "Не пройден тест соединения.";
                        isCheckFailed = !dbc.TestConnection();
                        break;
                    default:
                        msgErr = "Необрабатываемая проверка подключения.";
                        break;
                }
                if (isCheckFailed)
                {
                    MessageBox.Show(msgErr);
                    break;
                }
                if (i < countChecks)
                {
                    isCheckFailed = true;
                }
                else
                {
                    //файл настроек подключения прошел все проверки
                    return true;
                }
            }
            return false;
        }